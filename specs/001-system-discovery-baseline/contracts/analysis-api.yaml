openapi: 3.0.3
info:
  title: System Discovery and Baseline Assessment API
  description: |
    REST API for the Omega System Discovery and Baseline Assessment engine.
    Provides comprehensive analysis capabilities for Spring Boot monoliths including
    static analysis, runtime behavior monitoring, and migration readiness assessment.
  version: 1.0.0
  contact:
    name: Omega Migration System
    url: https://github.com/ea-datascience/omega
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://api.omega-migration.internal/v1
    description: Production server
  - url: https://staging-api.omega-migration.internal/v1
    description: Staging server
  - url: http://localhost:8000/v1
    description: Development server

tags:
  - name: projects
    description: Analysis project management
  - name: analysis
    description: Static and runtime analysis operations
  - name: baselines
    description: Performance baseline collection and management
  - name: assessments
    description: Risk and migration readiness assessments
  - name: boundaries
    description: Service boundary recommendations
  - name: compliance
    description: Compliance and security analysis
  - name: reports
    description: Report generation and export
  - name: validation
    description: Human-in-the-loop validation workflows
  - name: health
    description: System health and monitoring

security:
  - BearerAuth: []
  - OAuth2: [read, write, admin]

paths:
  # Analysis Project Management
  /projects:
    get:
      tags: [projects]
      summary: List analysis projects
      description: Retrieve a paginated list of analysis projects
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [queued, running, completed, failed, cancelled]
        - name: created_by
          in: query
          schema:
            type: string
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ProjectListResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "500":
          $ref: "#/components/responses/InternalServerError"

    post:
      tags: [projects]
      summary: Create analysis project
      description: Create a new analysis project for a Spring Boot monolith
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateProjectRequest"
      responses:
        "201":
          description: Project created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AnalysisProject"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /projects/{project_id}:
    get:
      tags: [projects]
      summary: Get analysis project
      description: Retrieve detailed information about a specific analysis project
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AnalysisProject"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

    put:
      tags: [projects]
      summary: Update analysis project
      description: Update analysis project configuration and metadata
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateProjectRequest"
      responses:
        "200":
          description: Project updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AnalysisProject"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

    delete:
      tags: [projects]
      summary: Delete analysis project
      description: Delete an analysis project and all associated data
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Project deleted successfully
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  # Analysis Operations
  /projects/{project_id}/analysis:
    post:
      tags: [analysis]
      summary: Start analysis
      description: Initiate static and runtime analysis for the project
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StartAnalysisRequest"
      responses:
        "202":
          description: Analysis started successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AnalysisStatus"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          description: Analysis already running
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    get:
      tags: [analysis]
      summary: Get analysis status
      description: Retrieve current status of analysis execution
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Analysis status retrieved
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AnalysisStatus"
        "404":
          $ref: "#/components/responses/NotFound"

  /projects/{project_id}/analysis/architecture:
    get:
      tags: [analysis]
      summary: Get system architecture
      description: Retrieve discovered system architecture and C4 diagrams
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: System architecture retrieved
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SystemArchitecture"
        "404":
          $ref: "#/components/responses/NotFound"

  /projects/{project_id}/analysis/dependencies:
    get:
      tags: [analysis]
      summary: Get dependency graph
      description: Retrieve static and runtime dependency analysis results
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: graph_type
          in: query
          schema:
            type: string
            enum: [static, runtime, combined]
            default: combined
      responses:
        "200":
          description: Dependency graph retrieved
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DependencyGraph"
        "404":
          $ref: "#/components/responses/NotFound"

  # Performance Baselines
  /projects/{project_id}/baselines:
    get:
      tags: [baselines]
      summary: List performance baselines
      description: Retrieve performance baselines for the project
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: environment_type
          in: query
          schema:
            type: string
            enum: [production, staging, development, synthetic]
      responses:
        "200":
          description: Performance baselines retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/PerformanceBaseline"
        "404":
          $ref: "#/components/responses/NotFound"

    post:
      tags: [baselines]
      summary: Create performance baseline
      description: Start performance baseline collection
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateBaselineRequest"
      responses:
        "201":
          description: Baseline collection started
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PerformanceBaseline"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  # Risk Assessments
  /projects/{project_id}/assessments:
    get:
      tags: [assessments]
      summary: Get risk assessments
      description: Retrieve migration readiness and risk assessments
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Risk assessments retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/RiskAssessment"
        "404":
          $ref: "#/components/responses/NotFound"

    post:
      tags: [assessments]
      summary: Generate risk assessment
      description: Generate new risk and migration readiness assessment
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GenerateAssessmentRequest"
      responses:
        "201":
          description: Assessment generated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RiskAssessment"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  # Service Boundaries
  /projects/{project_id}/boundaries:
    get:
      tags: [boundaries]
      summary: List service boundaries
      description: Retrieve recommended service boundary definitions
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: extraction_complexity
          in: query
          schema:
            type: string
            enum: [low, medium, high, very_high]
        - name: architect_approval
          in: query
          schema:
            type: string
            enum: [pending, approved, rejected, needs_revision]
      responses:
        "200":
          description: Service boundaries retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ServiceBoundary"
        "404":
          $ref: "#/components/responses/NotFound"

    post:
      tags: [boundaries]
      summary: Create service boundary
      description: Create new service boundary recommendation
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateBoundaryRequest"
      responses:
        "201":
          description: Service boundary created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ServiceBoundary"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /projects/{project_id}/boundaries/{boundary_id}/approve:
    post:
      tags: [boundaries, validation]
      summary: Approve service boundary
      description: Architect approval workflow for service boundary recommendation
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: boundary_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BoundaryApprovalRequest"
      responses:
        "200":
          description: Boundary approval updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ServiceBoundary"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  # Compliance
  /projects/{project_id}/compliance:
    get:
      tags: [compliance]
      summary: Get compliance records
      description: Retrieve compliance and security analysis results
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Compliance records retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ComplianceRecord"
        "404":
          $ref: "#/components/responses/NotFound"

  # Reports
  /projects/{project_id}/reports:
    get:
      tags: [reports]
      summary: List available reports
      description: Retrieve list of available reports for the project
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Available reports listed
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ReportSummary"
        "404":
          $ref: "#/components/responses/NotFound"

  /projects/{project_id}/reports/comprehensive:
    post:
      tags: [reports]
      summary: Generate comprehensive report
      description: Generate comprehensive analysis report with all findings
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GenerateReportRequest"
      responses:
        "202":
          description: Report generation started
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ReportGenerationStatus"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /projects/{project_id}/reports/{report_id}:
    get:
      tags: [reports]
      summary: Download report
      description: Download generated report in specified format
      parameters:
        - name: project_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: report_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: format
          in: query
          schema:
            type: string
            enum: [json, pdf, html, xlsx]
            default: json
      responses:
        "200":
          description: Report downloaded successfully
          content:
            application/json:
              schema:
                type: object
            application/pdf:
              schema:
                type: string
                format: binary
            text/html:
              schema:
                type: string
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
        "404":
          $ref: "#/components/responses/NotFound"

  # Health and Monitoring
  /health:
    get:
      tags: [health]
      summary: Health check
      description: System health check endpoint
      responses:
        "200":
          description: System healthy
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthStatus"
        "503":
          description: System unhealthy
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthStatus"

  /metrics:
    get:
      tags: [health]
      summary: System metrics
      description: Prometheus-compatible metrics endpoint
      responses:
        "200":
          description: Metrics retrieved
          content:
            text/plain:
              schema:
                type: string

components:
  schemas:
    # Core Entities
    AnalysisProject:
      type: object
      required:
        - id
        - name
        - repository_url
        - target_system_type
        - status
        - created_at
        - created_by
      properties:
        id:
          type: string
          format: uuid
          description: Unique project identifier
        name:
          type: string
          minLength: 1
          maxLength: 255
          description: Human-readable project name
        description:
          type: string
          nullable: true
          description: Project description and context
        repository_url:
          type: string
          format: uri
          description: Git repository URL for source code
        repository_branch:
          type: string
          default: main
          description: Target branch for analysis
        target_system_type:
          type: string
          enum: [spring_boot, spring_mvc, java_ee, other]
          description: Type of system being analyzed
        analysis_configuration:
          type: object
          description: Tool-specific configuration settings
        status:
          type: string
          enum: [queued, running, completed, failed, cancelled]
          description: Current project status
        progress_percentage:
          type: integer
          minimum: 0
          maximum: 100
          description: Analysis completion percentage
        created_at:
          type: string
          format: date-time
          description: Project creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
        completed_at:
          type: string
          format: date-time
          nullable: true
          description: Analysis completion timestamp
        created_by:
          type: string
          description: User who created the project
        validation_status:
          type: string
          enum: [pending, approved, rejected, needs_review]
          nullable: true
          description: Human validation status
        validation_notes:
          type: string
          nullable: true
          description: Validation feedback

    SystemArchitecture:
      type: object
      required:
        - id
        - analysis_project_id
        - architecture_style
        - domain_model
        - c4_model
        - technology_stack
        - discovered_at
      properties:
        id:
          type: string
          format: uuid
        analysis_project_id:
          type: string
          format: uuid
        architecture_style:
          type: string
          enum: [layered, modular_monolith, microservices, hybrid, unknown]
        domain_model:
          type: object
          description: Discovered bounded contexts and aggregates
        c4_model:
          type: object
          description: Context, Container, Component, Code diagrams
        technology_stack:
          type: object
          description: Frameworks, libraries, dependencies
        architectural_patterns:
          type: object
          description: Design patterns and anti-patterns
        quality_metrics:
          type: object
          description: Code quality and technical debt scores
        documentation_coverage:
          type: number
          minimum: 0
          maximum: 1
        test_coverage:
          type: number
          minimum: 0
          maximum: 1
        generated_diagrams:
          type: object
          description: PlantUML and Mermaid diagram definitions
        discovered_at:
          type: string
          format: date-time
        tool_versions:
          type: object
          description: Analysis tool versions used

    DependencyGraph:
      type: object
      required:
        - id
        - analysis_project_id
        - graph_type
        - nodes
        - edges
        - generated_at
      properties:
        id:
          type: string
          format: uuid
        analysis_project_id:
          type: string
          format: uuid
        graph_type:
          type: string
          enum: [static, runtime, combined]
        nodes:
          type: object
          description: Graph nodes (modules, services, databases)
        edges:
          type: object
          description: Graph edges (dependencies, communications)
        coupling_metrics:
          type: object
          description: Coupling strength measurements
        external_dependencies:
          type: object
          description: External system integrations
        data_dependencies:
          type: object
          description: Database schemas and data flows
        circular_dependencies:
          type: object
          description: Circular dependency cycles
        critical_path_analysis:
          type: object
          description: Critical dependency paths
        confidence_score:
          type: number
          minimum: 0
          maximum: 1
        generated_at:
          type: string
          format: date-time
        validation_status:
          type: string
          enum: [unvalidated, validated, disputed]

    PerformanceBaseline:
      type: object
      required:
        - id
        - analysis_project_id
        - collection_period_start
        - collection_period_end
        - environment_type
        - response_time_metrics
        - statistical_confidence
        - sample_size
      properties:
        id:
          type: string
          format: uuid
        analysis_project_id:
          type: string
          format: uuid
        collection_period_start:
          type: string
          format: date-time
        collection_period_end:
          type: string
          format: date-time
        environment_type:
          type: string
          enum: [production, staging, development, synthetic]
        load_characteristics:
          type: object
          description: Traffic patterns and user behavior
        response_time_metrics:
          type: object
          description: P50, P95, P99 latency with confidence intervals
        throughput_metrics:
          type: object
          description: Requests per second, transactions per minute
        error_rate_metrics:
          type: object
          description: Error frequencies by type
        resource_utilization:
          type: object
          description: CPU, memory, disk, network usage
        database_performance:
          type: object
          description: Query performance and connection metrics
        external_service_metrics:
          type: object
          description: External dependency response times
        statistical_confidence:
          type: number
          minimum: 0
          maximum: 1
          description: Statistical confidence in measurements
        sample_size:
          type: integer
          minimum: 1
          description: Number of measurements collected
        data_quality_score:
          type: number
          minimum: 0
          maximum: 1

    RiskAssessment:
      type: object
      required:
        - id
        - analysis_project_id
        - overall_risk_score
        - migration_complexity_score
        - go_no_go_recommendation
        - recommendation_rationale
        - assessed_at
      properties:
        id:
          type: string
          format: uuid
        analysis_project_id:
          type: string
          format: uuid
        overall_risk_score:
          type: number
          minimum: 0
          maximum: 10
        migration_complexity_score:
          type: number
          minimum: 0
          maximum: 10
        business_impact_score:
          type: number
          minimum: 0
          maximum: 10
        technical_debt_score:
          type: number
          minimum: 0
          maximum: 10
        coupling_risk_factors:
          type: object
          description: High coupling areas and risks
        dependency_risk_factors:
          type: object
          description: External dependency risks
        data_migration_risks:
          type: object
          description: Data consistency risks
        performance_risks:
          type: object
          description: Performance degradation risks
        security_risks:
          type: object
          description: Security vulnerabilities
        organizational_risks:
          type: object
          description: Team readiness risks
        mitigation_strategies:
          type: object
          description: Risk mitigation approaches
        go_no_go_recommendation:
          type: string
          enum: [go, no_go, conditional_go]
        recommendation_rationale:
          type: string
          description: Reasoning for recommendation
        assessed_at:
          type: string
          format: date-time
        reviewed_by:
          type: string
          nullable: true

    ServiceBoundary:
      type: object
      required:
        - id
        - analysis_project_id
        - boundary_name
        - boundary_description
        - domain_context
        - extraction_complexity
        - effort_estimate_days
        - confidence_level
      properties:
        id:
          type: string
          format: uuid
        analysis_project_id:
          type: string
          format: uuid
        boundary_name:
          type: string
          minLength: 1
          maxLength: 255
        boundary_description:
          type: string
          description: Business capability and scope
        domain_context:
          type: string
          description: DDD bounded context
        included_components:
          type: object
          description: Code modules and classes
        api_surface:
          type: object
          description: Proposed interfaces and contracts
        data_ownership:
          type: object
          description: Database tables and schemas
        external_dependencies:
          type: object
          description: External system integrations
        coupling_strength:
          type: number
          minimum: 0
          maximum: 10
        cohesion_score:
          type: number
          minimum: 0
          maximum: 10
        extraction_complexity:
          type: string
          enum: [low, medium, high, very_high]
        effort_estimate_days:
          type: integer
          minimum: 1
        risk_factors:
          type: object
          description: Extraction risks
        prerequisites:
          type: object
          description: Required preparation work
        migration_order:
          type: integer
          nullable: true
        confidence_level:
          type: number
          minimum: 0
          maximum: 1
        architect_approval:
          type: string
          enum: [pending, approved, rejected, needs_revision]
          nullable: true
        approval_notes:
          type: string
          nullable: true

    ComplianceRecord:
      type: object
      required:
        - id
        - analysis_project_id
        - regulatory_frameworks
        - compliance_status
        - last_assessment_date
        - assessor
      properties:
        id:
          type: string
          format: uuid
        analysis_project_id:
          type: string
          format: uuid
        regulatory_frameworks:
          type: object
          description: Applicable regulations
        data_classifications:
          type: object
          description: PII, PHI, financial data inventories
        privacy_obligations:
          type: object
          description: Data processing purposes
        security_controls:
          type: object
          description: Security measures and controls
        audit_requirements:
          type: object
          description: Audit trail requirements
        compliance_gaps:
          type: object
          description: Compliance deficiencies
        remediation_plans:
          type: object
          description: Gap remediation plans
        evidence_artifacts:
          type: object
          description: Supporting documentation
        compliance_status:
          type: string
          enum: [compliant, non_compliant, partial, unknown]
        last_assessment_date:
          type: string
          format: date-time
        next_review_date:
          type: string
          format: date-time
        assessor:
          type: string

    # Request/Response Schemas
    CreateProjectRequest:
      type: object
      required:
        - name
        - repository_url
        - target_system_type
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        description:
          type: string
          nullable: true
        repository_url:
          type: string
          format: uri
        repository_branch:
          type: string
          default: main
        target_system_type:
          type: string
          enum: [spring_boot, spring_mvc, java_ee, other]
        analysis_configuration:
          type: object
          default: {}

    UpdateProjectRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        description:
          type: string
          nullable: true
        repository_branch:
          type: string
        analysis_configuration:
          type: object
        validation_status:
          type: string
          enum: [pending, approved, rejected, needs_review]
        validation_notes:
          type: string

    StartAnalysisRequest:
      type: object
      properties:
        analysis_types:
          type: array
          items:
            type: string
            enum: [static, runtime, gap_analysis, risk_assessment]
          default: [static, runtime, gap_analysis, risk_assessment]
        static_analysis_config:
          type: object
          description: Static analysis tool configuration
        runtime_analysis_config:
          type: object
          description: Runtime analysis configuration

    CreateBaselineRequest:
      type: object
      required:
        - environment_type
        - collection_duration_hours
      properties:
        environment_type:
          type: string
          enum: [production, staging, development, synthetic]
        collection_duration_hours:
          type: integer
          minimum: 24
          maximum: 168
          description: Collection period in hours (24-168)
        instrumentation_config:
          type: object
          description: OpenTelemetry configuration

    GenerateAssessmentRequest:
      type: object
      properties:
        assessment_types:
          type: array
          items:
            type: string
            enum:
              [migration_readiness, technical_risk, business_impact, compliance]
          default: [migration_readiness, technical_risk]
        risk_tolerance:
          type: string
          enum: [low, medium, high]
          default: medium

    CreateBoundaryRequest:
      type: object
      required:
        - boundary_name
        - boundary_description
        - domain_context
      properties:
        boundary_name:
          type: string
          minLength: 1
          maxLength: 255
        boundary_description:
          type: string
        domain_context:
          type: string
        included_components:
          type: object
        manual_review_requested:
          type: boolean
          default: false

    BoundaryApprovalRequest:
      type: object
      required:
        - approval_decision
      properties:
        approval_decision:
          type: string
          enum: [approve, reject, needs_revision]
        approval_notes:
          type: string
        suggested_changes:
          type: object
          nullable: true

    GenerateReportRequest:
      type: object
      properties:
        report_type:
          type: string
          enum: [executive_summary, technical_detailed, compliance_audit]
          default: technical_detailed
        include_sections:
          type: array
          items:
            type: string
            enum:
              [
                architecture,
                dependencies,
                performance,
                risks,
                boundaries,
                compliance,
              ]
          default: [architecture, dependencies, performance, risks, boundaries]
        format:
          type: string
          enum: [json, pdf, html, xlsx]
          default: pdf

    # Response Schemas
    ProjectListResponse:
      type: object
      required:
        - projects
        - pagination
      properties:
        projects:
          type: array
          items:
            $ref: "#/components/schemas/AnalysisProject"
        pagination:
          $ref: "#/components/schemas/PaginationInfo"

    PaginationInfo:
      type: object
      required:
        - page
        - limit
        - total_count
        - total_pages
      properties:
        page:
          type: integer
          minimum: 1
        limit:
          type: integer
          minimum: 1
        total_count:
          type: integer
          minimum: 0
        total_pages:
          type: integer
          minimum: 0
        has_next:
          type: boolean
        has_previous:
          type: boolean

    AnalysisStatus:
      type: object
      required:
        - project_id
        - status
        - progress_percentage
        - current_phase
      properties:
        project_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [queued, running, completed, failed, cancelled]
        progress_percentage:
          type: integer
          minimum: 0
          maximum: 100
        current_phase:
          type: string
          enum:
            [
              static_analysis,
              runtime_analysis,
              gap_analysis,
              risk_assessment,
              report_generation,
            ]
          nullable: true
        phase_details:
          type: object
          description: Current phase specific details
        estimated_completion:
          type: string
          format: date-time
          nullable: true
        error_message:
          type: string
          nullable: true

    ReportSummary:
      type: object
      required:
        - id
        - report_type
        - status
        - created_at
      properties:
        id:
          type: string
          format: uuid
        report_type:
          type: string
          enum: [executive_summary, technical_detailed, compliance_audit]
        status:
          type: string
          enum: [generating, completed, failed]
        format:
          type: string
          enum: [json, pdf, html, xlsx]
        file_size_bytes:
          type: integer
          nullable: true
        created_at:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time
          nullable: true
        download_url:
          type: string
          format: uri
          nullable: true

    ReportGenerationStatus:
      type: object
      required:
        - report_id
        - status
        - created_at
      properties:
        report_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [queued, generating, completed, failed]
        progress_percentage:
          type: integer
          minimum: 0
          maximum: 100
        estimated_completion:
          type: string
          format: date-time
          nullable: true
        created_at:
          type: string
          format: date-time
        error_message:
          type: string
          nullable: true

    HealthStatus:
      type: object
      required:
        - status
        - timestamp
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        timestamp:
          type: string
          format: date-time
        services:
          type: object
          additionalProperties:
            type: object
            properties:
              status:
                type: string
                enum: [up, down, degraded]
              response_time_ms:
                type: number
              error_message:
                type: string
                nullable: true
        version:
          type: string
        uptime_seconds:
          type: integer

    ErrorResponse:
      type: object
      required:
        - error
        - message
        - timestamp
      properties:
        error:
          type: string
          description: Error code or type
        message:
          type: string
          description: Human-readable error message
        details:
          type: object
          nullable: true
          description: Additional error details
        timestamp:
          type: string
          format: date-time
        request_id:
          type: string
          description: Request correlation ID

  responses:
    BadRequest:
      description: Bad request - invalid input
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Unauthorized:
      description: Unauthorized - authentication required
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Forbidden:
      description: Forbidden - insufficient permissions
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token authentication

    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://auth.omega-migration.internal/oauth/authorize
          tokenUrl: https://auth.omega-migration.internal/oauth/token
          scopes:
            read: Read access to analysis projects and results
            write: Create and update analysis projects
            admin: Administrative access to all system features
